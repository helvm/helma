<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css">
span.lineno { color: white; background: #aaaaaa; border-right: solid white 12px }
span.nottickedoff { background: yellow}
span.istickedoff { background: white }
span.tickonlyfalse { margin: -1px; border: 1px solid #f20913; background: #f20913 }
span.tickonlytrue  { margin: -1px; border: 1px solid #60de51; background: #60de51 }
span.funcount { font-size: small; color: orange; z-index: 2; position: absolute; right: 20 }
span.decl { font-weight: bold }
span.spaces    { background: white }
</style>
</head>
<body>
<pre>
<span class="decl"><span class="nottickedoff">never executed</span> <span class="tickonlytrue">always true</span> <span class="tickonlyfalse">always false</span></span>
</pre>
<pre>
<span class="lineno">    1 </span>module HelVM.HelMA.Automata.LazyK.Rst76.InputEncoder (
<span class="lineno">    2 </span>  readInput,
<span class="lineno">    3 </span>  eof,
<span class="lineno">    4 </span>  pre,
<span class="lineno">    5 </span>  suc,
<span class="lineno">    6 </span>  church,
<span class="lineno">    7 </span>) where
<span class="lineno">    8 </span>
<span class="lineno">    9 </span>import           HelVM.HelMA.Automata.LazyK.Rst76.Constants
<span class="lineno">   10 </span>
<span class="lineno">   11 </span>import           HelVM.HelMA.Automata.LazyK.Constants
<span class="lineno">   12 </span>import           HelVM.HelMA.Automata.LazyK.Lambda
<span class="lineno">   13 </span>
<span class="lineno">   14 </span>import qualified Data.ByteString.Lazy                       as LBS
<span class="lineno">   15 </span>
<span class="lineno">   16 </span>readInput :: LBS.ByteString -&gt; Lambda
<span class="lineno">   17 </span><span class="decl"><span class="istickedoff">readInput = encodeInput . fmap <span class="nottickedoff">fromIntegral</span> . LBS.unpack</span></span>
<span class="lineno">   18 </span>
<span class="lineno">   19 </span>encodeInput :: [Natural] -&gt; Lambda
<span class="lineno">   20 </span><span class="decl"><span class="istickedoff">encodeInput = foldr <span class="nottickedoff">(consXY . church)</span> eof</span></span>
<span class="lineno">   21 </span>
<span class="lineno">   22 </span>eof :: Lambda
<span class="lineno">   23 </span><span class="decl"><span class="istickedoff">eof = K `App` church 256</span></span>
<span class="lineno">   24 </span>
<span class="lineno">   25 </span>pre :: Lambda
<span class="lineno">   26 </span><span class="decl"><span class="nottickedoff">pre = delete (Var &quot;n&quot;) $ Var &quot;n&quot; `App` f `App` (K `App` church 0) `App` I</span>
<span class="lineno">   27 </span><span class="spaces">  </span><span class="nottickedoff">where</span>
<span class="lineno">   28 </span><span class="spaces">  </span><span class="nottickedoff">f = delete (Var &quot;x&quot;) $ delete (Var &quot;y&quot;) $ Var &quot;y&quot; `App` (Var &quot;x&quot; `App` suc)</span></span>
<span class="lineno">   29 </span>
<span class="lineno">   30 </span>suc :: Lambda
<span class="lineno">   31 </span><span class="decl"><span class="istickedoff">suc = App S b</span></span>
<span class="lineno">   32 </span>
<span class="lineno">   33 </span>church :: Natural -&gt; Lambda
<span class="lineno">   34 </span><span class="decl"><span class="istickedoff">church 0   = <span class="nottickedoff">App S K</span></span>
<span class="lineno">   35 </span><span class="spaces"></span><span class="istickedoff">church 1   = <span class="nottickedoff">I</span></span>
<span class="lineno">   36 </span><span class="spaces"></span><span class="istickedoff">church 2   = suc `App` I</span>
<span class="lineno">   37 </span><span class="spaces"></span><span class="istickedoff">church 4   = m `App` church 2</span>
<span class="lineno">   38 </span><span class="spaces"></span><span class="istickedoff">church 8   = <span class="nottickedoff">S `App` (S `App` b) `App` I `App` church 2</span></span>
<span class="lineno">   39 </span><span class="spaces"></span><span class="istickedoff">church 16  = <span class="nottickedoff">si `App` m `App` church 2</span></span>
<span class="lineno">   40 </span><span class="spaces"></span><span class="istickedoff">church 256 = m `App` church 4</span>
<span class="lineno">   41 </span><span class="spaces"></span><span class="istickedoff">church n   = <span class="nottickedoff">numB n `App` b</span></span></span>
<span class="lineno">   42 </span>
<span class="lineno">   43 </span>numB :: Natural -&gt; Lambda
<span class="lineno">   44 </span><span class="decl"><span class="nottickedoff">numB 0 = K `App` false</span>
<span class="lineno">   45 </span><span class="spaces"></span><span class="nottickedoff">numB 1 = false</span>
<span class="lineno">   46 </span><span class="spaces"></span><span class="nottickedoff">numB 2 = ss `App` numB 1</span>
<span class="lineno">   47 </span><span class="spaces"></span><span class="nottickedoff">numB 3 = ss `App` numB 2</span>
<span class="lineno">   48 </span><span class="spaces"></span><span class="nottickedoff">numB 4 = ssi `App` numB 2</span>
<span class="lineno">   49 </span><span class="spaces"></span><span class="nottickedoff">numB 5 = ss `App` numB 4</span>
<span class="lineno">   50 </span><span class="spaces"></span><span class="nottickedoff">numB 6 = ssss1 `App` numB 2</span>
<span class="lineno">   51 </span><span class="spaces"></span><span class="nottickedoff">numB 7 = ss `App` numB 6</span>
<span class="lineno">   52 </span><span class="spaces"></span><span class="nottickedoff">numB 8 = S `App` numB 3 `App` numB 2</span>
<span class="lineno">   53 </span><span class="spaces"></span><span class="nottickedoff">numB 9 = ssss `App` numB 2</span>
<span class="lineno">   54 </span><span class="spaces"></span><span class="nottickedoff">numB 10 = ss `App` numB 9</span>
<span class="lineno">   55 </span><span class="spaces"></span><span class="nottickedoff">numB 11 = ss `App` numB 10</span>
<span class="lineno">   56 </span><span class="spaces"></span><span class="nottickedoff">numB 12 = S `App` (ss `App` sss) `App` numB 2</span>
<span class="lineno">   57 </span><span class="spaces"></span><span class="nottickedoff">numB 13 = ss `App` numB 12</span>
<span class="lineno">   58 </span><span class="spaces"></span><span class="nottickedoff">numB 14 = ss `App` numB 13</span>
<span class="lineno">   59 </span><span class="spaces"></span><span class="nottickedoff">numB 15 = S `App` (ss `App` ssiss) `App` numB 3</span>
<span class="lineno">   60 </span><span class="spaces"></span><span class="nottickedoff">numB 16 = ss `App` ssi `App` numB 2</span>
<span class="lineno">   61 </span><span class="spaces"></span><span class="nottickedoff">numB 17 = ss `App` numB 16</span>
<span class="lineno">   62 </span><span class="spaces"></span><span class="nottickedoff">numB 18 = ss `App` numB 17</span>
<span class="lineno">   63 </span><span class="spaces"></span><span class="nottickedoff">numB 19 = ss `App` numB 18</span>
<span class="lineno">   64 </span><span class="spaces"></span><span class="nottickedoff">numB 20 = ssss1 `App` numB 4</span>
<span class="lineno">   65 </span><span class="spaces"></span><span class="nottickedoff">numB 21 = ss `App` numB 20</span>
<span class="lineno">   66 </span><span class="spaces"></span><span class="nottickedoff">numB 22 = ss `App` numB 21</span>
<span class="lineno">   67 </span><span class="spaces"></span><span class="nottickedoff">numB 23 = ss `App` numB 22</span>
<span class="lineno">   68 </span><span class="spaces"></span><span class="nottickedoff">numB 24 = S `App` (ss `App` (ss `App` sss)) `App` numB 2</span>
<span class="lineno">   69 </span><span class="spaces"></span><span class="nottickedoff">numB 25 = ss `App` (S `App` (K `App` ss) `App` ssi) `App` numB 2</span>
<span class="lineno">   70 </span><span class="spaces"></span><span class="nottickedoff">numB 26 = ss `App` numB 25</span>
<span class="lineno">   71 </span><span class="spaces"></span><span class="nottickedoff">numB 27 = ssi `App` numB 3</span>
<span class="lineno">   72 </span><span class="spaces"></span><span class="nottickedoff">numB 28 = ss `App` numB 27</span>
<span class="lineno">   73 </span><span class="spaces"></span><span class="nottickedoff">numB 29 = ss `App` numB 28</span>
<span class="lineno">   74 </span><span class="spaces"></span><span class="nottickedoff">numB 30 = ssss1 `App` numB 5</span>
<span class="lineno">   75 </span><span class="spaces"></span><span class="nottickedoff">numB 31 = ss `App` numB 30</span>
<span class="lineno">   76 </span><span class="spaces"></span><span class="nottickedoff">numB 32 = S `App` numB 5 `App` numB 2</span>
<span class="lineno">   77 </span><span class="spaces"></span><span class="nottickedoff">numB 33 = ss `App` numB 32</span>
<span class="lineno">   78 </span><span class="spaces"></span><span class="nottickedoff">numB 34 = ss `App` numB 33</span>
<span class="lineno">   79 </span><span class="spaces"></span><span class="nottickedoff">numB 35 = S `App` (ss `App` ssiss) `App` numB 5</span>
<span class="lineno">   80 </span><span class="spaces"></span><span class="nottickedoff">numB 36 = ss `App` ssss1 `App` numB 2</span>
<span class="lineno">   81 </span><span class="spaces"></span><span class="nottickedoff">numB 37 = ss `App` numB 36</span>
<span class="lineno">   82 </span><span class="spaces"></span><span class="nottickedoff">numB 38 = ss `App` numB 37</span>
<span class="lineno">   83 </span><span class="spaces"></span><span class="nottickedoff">numB 39 = ss `App` numB 38</span>
<span class="lineno">   84 </span><span class="spaces"></span><span class="nottickedoff">numB 40 = S `App` (si `App` numB 2) `App` numB 20</span>
<span class="lineno">   85 </span><span class="spaces"></span><span class="nottickedoff">numB 41 = ss `App` numB 40</span>
<span class="lineno">   86 </span><span class="spaces"></span><span class="nottickedoff">numB 42 = ssss1 `App` numB 6</span>
<span class="lineno">   87 </span><span class="spaces"></span><span class="nottickedoff">numB 43 = ss `App` numB 42</span>
<span class="lineno">   88 </span><span class="spaces"></span><span class="nottickedoff">numB 44 = ss `App` numB 43</span>
<span class="lineno">   89 </span><span class="spaces"></span><span class="nottickedoff">numB 45 = S `App` (ss `App` (ss `App` ssiss)) `App` numB 3</span>
<span class="lineno">   90 </span><span class="spaces"></span><span class="nottickedoff">numB 46 = ss `App` numB 45</span>
<span class="lineno">   91 </span><span class="spaces"></span><span class="nottickedoff">numB 47 = ss `App` numB 46</span>
<span class="lineno">   92 </span><span class="spaces"></span><span class="nottickedoff">numB 48 = S `App` (ss `App` (ss `App` (ss `App` sss))) `App` numB 2</span>
<span class="lineno">   93 </span><span class="spaces"></span><span class="nottickedoff">numB 49 = ss `App` (S `App` (K `App` ss) `App` ssss1) `App` numB 2</span>
<span class="lineno">   94 </span><span class="spaces"></span><span class="nottickedoff">numB 50 = ss `App` numB 49</span>
<span class="lineno">   95 </span><span class="spaces"></span><span class="nottickedoff">numB 51 = ss `App` numB 50</span>
<span class="lineno">   96 </span><span class="spaces"></span><span class="nottickedoff">numB 52 = ss `App` numB 51</span>
<span class="lineno">   97 </span><span class="spaces"></span><span class="nottickedoff">numB 53 = ss `App` numB 52</span>
<span class="lineno">   98 </span><span class="spaces"></span><span class="nottickedoff">numB 54 = S `App` (si `App` numB 2) `App` numB 27</span>
<span class="lineno">   99 </span><span class="spaces"></span><span class="nottickedoff">numB 55 = ss `App` numB 54</span>
<span class="lineno">  100 </span><span class="spaces"></span><span class="nottickedoff">numB 56 = ssss1 `App` numB 7</span>
<span class="lineno">  101 </span><span class="spaces"></span><span class="nottickedoff">numB 57 = ss `App` numB 56</span>
<span class="lineno">  102 </span><span class="spaces"></span><span class="nottickedoff">numB 58 = ss `App` numB 57</span>
<span class="lineno">  103 </span><span class="spaces"></span><span class="nottickedoff">numB 59 = ss `App` numB 58</span>
<span class="lineno">  104 </span><span class="spaces"></span><span class="nottickedoff">numB 60 = S `App` (si `App` numB 2) `App` numB 30</span>
<span class="lineno">  105 </span><span class="spaces"></span><span class="nottickedoff">numB 61 = ss `App` numB 60</span>
<span class="lineno">  106 </span><span class="spaces"></span><span class="nottickedoff">numB 62 = S `App` (si `App` numB 2) `App` numB 31</span>
<span class="lineno">  107 </span><span class="spaces"></span><span class="nottickedoff">numB 63 = S `App` (ss `App` ssiss) `App` numB 7</span>
<span class="lineno">  108 </span><span class="spaces"></span><span class="nottickedoff">numB 64 = ssss `App` numB 3</span>
<span class="lineno">  109 </span><span class="spaces"></span><span class="nottickedoff">numB 65 = ss `App` numB 64</span>
<span class="lineno">  110 </span><span class="spaces"></span><span class="nottickedoff">numB 66 = ss `App` numB 65</span>
<span class="lineno">  111 </span><span class="spaces"></span><span class="nottickedoff">numB 67 = ss `App` numB 66</span>
<span class="lineno">  112 </span><span class="spaces"></span><span class="nottickedoff">numB 68 = ss `App` numB 67</span>
<span class="lineno">  113 </span><span class="spaces"></span><span class="nottickedoff">numB 69 = ss `App` numB 68</span>
<span class="lineno">  114 </span><span class="spaces"></span><span class="nottickedoff">numB 70 = S `App` (S `App` numB 6 `App` S) `App` numB 64</span>
<span class="lineno">  115 </span><span class="spaces"></span><span class="nottickedoff">numB 71 = ss `App` numB 70</span>
<span class="lineno">  116 </span><span class="spaces"></span><span class="nottickedoff">numB 72 = ssss1 `App` numB 8</span>
<span class="lineno">  117 </span><span class="spaces"></span><span class="nottickedoff">numB 73 = ss `App` numB 72</span>
<span class="lineno">  118 </span><span class="spaces"></span><span class="nottickedoff">numB 74 = S `App` (si `App` numB 2) `App` numB 37</span>
<span class="lineno">  119 </span><span class="spaces"></span><span class="nottickedoff">numB 75 = ss `App` numB 74</span>
<span class="lineno">  120 </span><span class="spaces"></span><span class="nottickedoff">numB 76 = S `App` (si `App` numB 2) `App` numB 38</span>
<span class="lineno">  121 </span><span class="spaces"></span><span class="nottickedoff">numB 77 = ss `App` numB 76</span>
<span class="lineno">  122 </span><span class="spaces"></span><span class="nottickedoff">numB 78 = S `App` (si `App` numB 2) `App` numB 39</span>
<span class="lineno">  123 </span><span class="spaces"></span><span class="nottickedoff">numB 79 = ss `App` numB 78</span>
<span class="lineno">  124 </span><span class="spaces"></span><span class="nottickedoff">numB 80 = S `App` (ss `App` sss) `App` numB 4</span>
<span class="lineno">  125 </span><span class="spaces"></span><span class="nottickedoff">numB 81 = ssssss `App` numB 2</span>
<span class="lineno">  126 </span><span class="spaces"></span><span class="nottickedoff">numB 82 = ss `App` numB 81</span>
<span class="lineno">  127 </span><span class="spaces"></span><span class="nottickedoff">numB 83 = ss `App` numB 82</span>
<span class="lineno">  128 </span><span class="spaces"></span><span class="nottickedoff">numB 84 = ss `App` numB 83</span>
<span class="lineno">  129 </span><span class="spaces"></span><span class="nottickedoff">numB 85 = ss `App` numB 84</span>
<span class="lineno">  130 </span><span class="spaces"></span><span class="nottickedoff">numB 86 = ss `App` numB 85</span>
<span class="lineno">  131 </span><span class="spaces"></span><span class="nottickedoff">numB 87 = S `App` (S `App` numB 6 `App` S) `App` numB 81</span>
<span class="lineno">  132 </span><span class="spaces"></span><span class="nottickedoff">numB 88 = ss `App` numB 87</span>
<span class="lineno">  133 </span><span class="spaces"></span><span class="nottickedoff">numB 89 = S `App` (S `App` numB 8 `App` S) `App` numB 81</span>
<span class="lineno">  134 </span><span class="spaces"></span><span class="nottickedoff">numB 90 = ssss1 `App` numB 9</span>
<span class="lineno">  135 </span><span class="spaces"></span><span class="nottickedoff">numB 91 = ss `App` numB 90</span>
<span class="lineno">  136 </span><span class="spaces"></span><span class="nottickedoff">numB 92 = ss `App` numB 91</span>
<span class="lineno">  137 </span><span class="spaces"></span><span class="nottickedoff">numB 93 = ss `App` numB 92</span>
<span class="lineno">  138 </span><span class="spaces"></span><span class="nottickedoff">numB 94 = ss `App` numB 93</span>
<span class="lineno">  139 </span><span class="spaces"></span><span class="nottickedoff">numB 95 = ss `App` numB 94</span>
<span class="lineno">  140 </span><span class="spaces"></span><span class="nottickedoff">numB 96 = S `App` (ss `App` (ss `App` (ss `App` (ss `App` sss)))) `App` numB 2</span>
<span class="lineno">  141 </span><span class="spaces"></span><span class="nottickedoff">numB 97 = ss `App` numB 96</span>
<span class="lineno">  142 </span><span class="spaces"></span><span class="nottickedoff">numB 98 = S `App` (si `App` numB 2) `App` numB 49</span>
<span class="lineno">  143 </span><span class="spaces"></span><span class="nottickedoff">numB 99 = S `App` (ss `App` ssiss) `App` numB 9</span>
<span class="lineno">  144 </span><span class="spaces"></span><span class="nottickedoff">numB 100 = S `App` numB 2 `App` numB 10</span>
<span class="lineno">  145 </span><span class="spaces"></span><span class="nottickedoff">numB 101 = ss `App` numB 100</span>
<span class="lineno">  146 </span><span class="spaces"></span><span class="nottickedoff">numB 102 = ss `App` numB 101</span>
<span class="lineno">  147 </span><span class="spaces"></span><span class="nottickedoff">numB 103 = ss `App` numB 102</span>
<span class="lineno">  148 </span><span class="spaces"></span><span class="nottickedoff">numB 104 = ss `App` numB 103</span>
<span class="lineno">  149 </span><span class="spaces"></span><span class="nottickedoff">numB 105 = S `App` (S `App` numB 24 `App` S) `App` numB 81</span>
<span class="lineno">  150 </span><span class="spaces"></span><span class="nottickedoff">numB 106 = S `App` (S `App` numB 16 `App` S) `App` numB 90</span>
<span class="lineno">  151 </span><span class="spaces"></span><span class="nottickedoff">numB 107 = S `App` (S `App` numB 27 `App` S) `App` numB 80</span>
<span class="lineno">  152 </span><span class="spaces"></span><span class="nottickedoff">numB 108 = S `App` (ss `App` (ss `App` sss)) `App` numB 3</span>
<span class="lineno">  153 </span><span class="spaces"></span><span class="nottickedoff">numB 109 = ss `App` numB 108</span>
<span class="lineno">  154 </span><span class="spaces"></span><span class="nottickedoff">numB 110 = ssss1 `App` numB 10</span>
<span class="lineno">  155 </span><span class="spaces"></span><span class="nottickedoff">numB 111 = ss `App` numB 110</span>
<span class="lineno">  156 </span><span class="spaces"></span><span class="nottickedoff">numB 112 = ss `App` numB 111</span>
<span class="lineno">  157 </span><span class="spaces"></span><span class="nottickedoff">numB 113 = ss `App` numB 112</span>
<span class="lineno">  158 </span><span class="spaces"></span><span class="nottickedoff">numB 114 = ss `App` numB 113</span>
<span class="lineno">  159 </span><span class="spaces"></span><span class="nottickedoff">numB 115 = ss `App` numB 114</span>
<span class="lineno">  160 </span><span class="spaces"></span><span class="nottickedoff">numB 116 = S `App` (si `App` numB 4) `App` numB 29</span>
<span class="lineno">  161 </span><span class="spaces"></span><span class="nottickedoff">numB 117 = S `App` (S `App` numB 36 `App` S) `App` numB 81</span>
<span class="lineno">  162 </span><span class="spaces"></span><span class="nottickedoff">numB 118 = ss `App` numB 117</span>
<span class="lineno">  163 </span><span class="spaces"></span><span class="nottickedoff">numB 119 = S `App` (S `App` numB 9 `App` S) `App` numB 110</span>
<span class="lineno">  164 </span><span class="spaces"></span><span class="nottickedoff">numB 120 = S `App` (ss `App` ssiss) `App` numB 10</span>
<span class="lineno">  165 </span><span class="spaces"></span><span class="nottickedoff">numB 121 = S `App` numB 2 `App` numB 11</span>
<span class="lineno">  166 </span><span class="spaces"></span><span class="nottickedoff">numB 122 = ss `App` numB 121</span>
<span class="lineno">  167 </span><span class="spaces"></span><span class="nottickedoff">numB 123 = ss `App` numB 122</span>
<span class="lineno">  168 </span><span class="spaces"></span><span class="nottickedoff">numB 124 = ss `App` numB 123</span>
<span class="lineno">  169 </span><span class="spaces"></span><span class="nottickedoff">numB 125 = ss `App` (S `App` (K `App` ss) `App` ss) `App` numB 3</span>
<span class="lineno">  170 </span><span class="spaces"></span><span class="nottickedoff">numB 126 = ss `App` numB 125</span>
<span class="lineno">  171 </span><span class="spaces"></span><span class="nottickedoff">numB 127 = ss `App` numB 126</span>
<span class="lineno">  172 </span><span class="spaces"></span><span class="nottickedoff">numB 128 = S `App` numB 7 `App` numB 2</span>
<span class="lineno">  173 </span><span class="spaces"></span><span class="nottickedoff">numB 256 = ssi `App` numB 4</span>
<span class="lineno">  174 </span><span class="spaces"></span><span class="nottickedoff">numB n | n &lt; 256 = ss `App` numB (n - 1)</span>
<span class="lineno">  175 </span><span class="spaces"></span><span class="nottickedoff">numB n = error $ show n</span></span>

</pre>
</body>
</html>
